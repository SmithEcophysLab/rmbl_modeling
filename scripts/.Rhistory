## read data
env_data <- readRDS('../data/environmentaldata.monthly.rds')
head(env_data)
env_data$site
levels(env_data$site)
levels(as.factor(env_data$site))
# script to read in data from enquist lab and run p-model
## read data
env_data <- readRDS('../data/environmentaldata.monthly.rds')
head(env_data)
tail(env_data)
## read data
env_data <- readRDS('../data/environmentaldata.monthly.rds')
head(env_data)
env_data <- readRDS('../data/environmentaldata.monthly.rds')
head(env_data)
tail(env_data)
## read data
rmbl_data <- readRDS('../data/environmentaldata.monthly.rds')
levels(rmbl_data$site)
levels(as.factor(rmbl_data$site))
## read lat lon data
rmbl_latlon <- read.csv('../data/site_corrdinates.csv')
##libraries
library(tidyr)
## read data
rmbl_data_raw <- readRDS('../data/environmentaldata.monthly.rds')
## add in lat lon
rmbl_data_merge <- left_join(rmbl_data_raw, rmbl_latlon, by = 'site')
library(dplyr)
## add in lat lon
rmbl_data_merge <- left_join(rmbl_data_raw, rmbl_latlon, by = 'site')
head(rmbl_data_merge)
tail(rmbl_data_raw)
## read in climate data
cru_alpha_1901 = read.csv('~/Documents/Data/CRU3.24/alpha/cru_alpha_1901.csv')
subset(cru_alpha_1901, Lat = 38.25)
subset(cru_alpha_1901, Lat == 38.75)
subset(cru_alpha_1901, Lat == 38.75 & Lon == -106.75)
subset(cru_alpha_1901, Lat == 38.75 & Lon == -107.25) # 32590
row_pbm_pfeiler = 32589
row_almont_cbt_road = 32590
library(R.matlab)
install.packages('R.matlab')
library(R.matlab)
## read in climate data
cru_alpha_1901 = readMat('~/Documents/Data/CRU3.24/alpha/cru_alpha_1901.mat')
subset(cru_alpha_1901, Lat == 38.75 & Lon == -106.75) # 32590
head(cru_alpha_1901)
## read in climate data
cru_alpha_1901 = as.data.frame(readMat('~/Documents/Data/CRU3.24/alpha/cru_alpha_1901.mat'))
cru_alpha_1901_colnames =
head(cru_alpha_1901)
cru_alpha_1901_colnames =
head(cru_alpha_1901)
head(cru_alpha_1901)
cru_alpha_1901_colnames = read.csv('~/Documents/Data/CRU3.24/alpha/cru_alpha_1901.csv')
cru_alpha_1901_colnames = colnames(read.csv('~/Documents/Data/CRU3.24/alpha/cru_alpha_1901.csv'))
cru_alpha_1901_colnames
colnames(cru_alpha_1901) = cru_alpha_1901_colnames
head(cru_alpha_1901)
subset(cru_alpha_1901, Lat == 38.75 & Lon == -106.75) # 32590
subset(cru_alpha_1901, Lat == 38.75 & Lon == -107.25) # 32589
row_almont_cbt_road = 32590
row_pbm_pfeiler = 32589
vars = c('pre2','tmp2','vpd2','par','alpha')
ii = 1
yeari = 1
temp=rowMeans(readMat(paste('~/Documents/Data/CRU3.24/',vars[ii],'/cru_',varsFileN[ii],'_',yeari,'.mat',sep=''))[[1]][,3:14],dim=1)
temp=rowMeans(readMat(paste('~/Documents/Data/CRU3.24/',vars[ii],'/cru_',vars[ii],'_',yeari,'.mat',sep=''))[[1]][,3:14],dim=1)
temp=rowMeans(readMat(paste('~/Documents/Data/CRU3.24/',vars[ii],'/cru_',varsFileN[ii],'_',yeari,'.mat',sep=''))[[1]][,3:14],dim=1)
varsFileN = c('pre','tmp','vpd','par','alpha')
temp=rowMeans(readMat(paste('~/Documents/Data/CRU3.24/',vars[ii],'/cru_',varsFileN[ii],'_',yeari,'.mat',sep=''))[[1]][,3:14],dim=1)
1940:2015
yeari = 1940
temp=rowMeans(readMat(paste('~/Documents/Data/CRU3.24/',vars[ii],'/cru_',varsFileN[ii],'_',yeari,'.mat',sep=''))[[1]][,3:14],dim=1)
temp
temp=rowMeans(readMat(paste('~/Documents/Data/CRU3.24/',vars[ii],'/cru_',varsFileN[ii],'_',yeari,'.mat',sep=''))[[1]][row_almont_cbt_road,3:14],dim=1)
row_almont_cbt_road
temp=rowMeans(readMat(paste('~/Documents/Data/CRU3.24/',vars[ii],'/cru_',varsFileN[ii],'_',yeari,'.mat',sep=''))[[1]][32590,3:14],dim=1)
temp=readMat(paste('~/Documents/Data/CRU3.24/',vars[ii],'/cru_',varsFileN[ii],'_',yeari,'.mat',sep=''))[32590,3:14]
temp=as.data.frame(readMat(paste('~/Documents/Data/CRU3.24/',vars[ii],'/cru_',varsFileN[ii],'_',yeari,'.mat',sep='')))[32590,3:14]
temp
colnames(temp) = cru_alpha_1901_colnames
temp=as.data.frame(readMat(paste('~/Documents/Data/CRU3.24/',vars[ii],'/cru_',varsFileN[ii],'_',yeari,'.mat',sep='')))[32590,]
temp=as.vector(readMat(paste('~/Documents/Data/CRU3.24/',vars[ii],'/cru_',varsFileN[ii],'_',yeari,'.mat',sep='')))[32590,]
temp=as.vector(readMat(paste('~/Documents/Data/CRU3.24/',vars[ii],'/cru_',varsFileN[ii],'_',yeari,'.mat',sep='')))[[1]][32590,]
temp
values=as.vector(readMat(paste('~/Documents/Data/CRU3.24/',vars[ii],'/cru_',varsFileN[ii],'_',yeari,'.mat',sep='')))[[1]][32590,3:14]
months = c(1:12)
year = rep(yeari, 12)
tmp=as.vector(readMat(paste('~/Documents/Data/CRU3.24/tmp2/cru_tmp_',yeari,'.mat',sep='')))[[1]][32590,3:14]
months = c(1:12)
year = rep(yeari, 12)
tmp=as.vector(readMat(paste('~/Documents/Data/CRU3.24/tmp2/cru_tmp_',yeari,'.mat',sep='')))[[1]][32590,3:14]
par=as.vector(readMat(paste('~/Documents/Data/CRU3.24/par/cru_par_',yeari,'.mat',sep='')))[[1]][32590,3:14]
vpd=as.vector(readMat(paste('~/Documents/Data/CRU3.24/vpd2/cru_vpd_',yeari,'.mat',sep='')))[[1]][32590,3:14]
pre=as.vector(readMat(paste('~/Documents/Data/CRU3.24/pre2/cru_pre_',yeari,'.mat',sep='')))[[1]][32590,3:14]
per_year = cbind(months, year, tmp, par, vpd, pre)
per_year
month = c(1:12)
year = rep(yeari, 12)
tmp=as.vector(readMat(paste('~/Documents/Data/CRU3.24/tmp2/cru_tmp_',yeari,'.mat',sep='')))[[1]][32590,3:14]
par=as.vector(readMat(paste('~/Documents/Data/CRU3.24/par/cru_par_',yeari,'.mat',sep='')))[[1]][32590,3:14]
vpd=as.vector(readMat(paste('~/Documents/Data/CRU3.24/vpd2/cru_vpd_',yeari,'.mat',sep='')))[[1]][32590,3:14]
pre=as.vector(readMat(paste('~/Documents/Data/CRU3.24/pre2/cru_pre_',yeari,'.mat',sep='')))[[1]][32590,3:14]
per_year = cbind(month, year, tmp, par, vpd, pre)
all=rbind(all, per_year)
all=c()
month = c(1:12)
year = rep(yeari, 12)
tmp=as.vector(readMat(paste('~/Documents/Data/CRU3.24/tmp2/cru_tmp_',yeari,'.mat',sep='')))[[1]][32590,3:14]
par=as.vector(readMat(paste('~/Documents/Data/CRU3.24/par/cru_par_',yeari,'.mat',sep='')))[[1]][32590,3:14]
vpd=as.vector(readMat(paste('~/Documents/Data/CRU3.24/vpd2/cru_vpd_',yeari,'.mat',sep='')))[[1]][32590,3:14]
pre=as.vector(readMat(paste('~/Documents/Data/CRU3.24/pre2/cru_pre_',yeari,'.mat',sep='')))[[1]][32590,3:14]
per_year = cbind(month, year, tmp, par, vpd, pre)
all=rbind(all, per_year)
all
yeari = 1941
month = c(1:12)
year = rep(yeari, 12)
tmp=as.vector(readMat(paste('~/Documents/Data/CRU3.24/tmp2/cru_tmp_',yeari,'.mat',sep='')))[[1]][32590,3:14]
par=as.vector(readMat(paste('~/Documents/Data/CRU3.24/par/cru_par_',yeari,'.mat',sep='')))[[1]][32590,3:14]
vpd=as.vector(readMat(paste('~/Documents/Data/CRU3.24/vpd2/cru_vpd_',yeari,'.mat',sep='')))[[1]][32590,3:14]
pre=as.vector(readMat(paste('~/Documents/Data/CRU3.24/pre2/cru_pre_',yeari,'.mat',sep='')))[[1]][32590,3:14]
per_year = cbind(month, year, tmp, par, vpd, pre)
all=rbind(all, per_year)
all
cru_almont_cbt_road=c()
for (yeari in 1940:2015) {
month = c(1:12)
year = rep(yeari, 12)
tmp=as.vector(readMat(paste('~/Documents/Data/CRU3.24/tmp2/cru_tmp_',yeari,'.mat',sep='')))[[1]][32590,3:14]
par=as.vector(readMat(paste('~/Documents/Data/CRU3.24/par/cru_par_',yeari,'.mat',sep='')))[[1]][32590,3:14]
vpd=as.vector(readMat(paste('~/Documents/Data/CRU3.24/vpd2/cru_vpd_',yeari,'.mat',sep='')))[[1]][32590,3:14]
pre=as.vector(readMat(paste('~/Documents/Data/CRU3.24/pre2/cru_pre_',yeari,'.mat',sep='')))[[1]][32590,3:14]
per_year = cbind(month, year, tmp, par, vpd, pre)
cru_almont_cbt_road = rbind(cru_almont_cbt_road, per_year)
}
cru_pbm_pfeiler=c()
for (yeari in 1940:2015) {
month = c(1:12)
year = rep(yeari, 12)
tmp=as.vector(readMat(paste('~/Documents/Data/CRU3.24/tmp2/cru_tmp_',yeari,'.mat',sep='')))[[1]][32589,3:14]
par=as.vector(readMat(paste('~/Documents/Data/CRU3.24/par/cru_par_',yeari,'.mat',sep='')))[[1]][32589,3:14]
vpd=as.vector(readMat(paste('~/Documents/Data/CRU3.24/vpd2/cru_vpd_',yeari,'.mat',sep='')))[[1]][32589,3:14]
pre=as.vector(readMat(paste('~/Documents/Data/CRU3.24/pre2/cru_pre_',yeari,'.mat',sep='')))[[1]][32589,3:14]
per_year = cbind(month, year, tmp, par, vpd, pre)
cru_pbm_pfeiler = rbind(cru_pbm_pfeiler, per_year)
}
## add in lat lon
rmbl_data_merge <- left_join(rmbl_data_raw, rmbl_latlon, by = 'site')
head(rmbl_data_merge)
cru_almont = cru_almont_cbt_road
cru_almont$site = 'almont'
cru_almont = as.data.frame(cru_almont_cbt_road)
cru_almont$site = 'almont'
head(cru_almont)
cru_cbt = as.data.frame(cru_almont_cbt_road)
cru_cbt$site = 'cbt'
cru_road$site = 'road'
cru_pbm = as.data.frame(cru_pbm_pfeiler)
cru_pbm$site = 'pbm'
cru_road = as.data.frame(cru_almont_cbt_road)
cru_road$site = 'road'
cru_pbm = as.data.frame(cru_pbm_pfeiler)
cru_pbm$site = 'pbm'
cru_pfeiler = as.data.frame(cru_pbm_pfeiler)
cru_pfeiler$site = 'pfeiler'
cru_all = rbind(cru_almont, cru_cbt, cru_road, cru_pbm, cru_pfeiler)
head(cru_all)
## add in lat lon
rmbl_data_merge <- left_join(rmbl_data_raw, rmbl_latlon, by = 'site')
head(rmbl_data_merge)
## add in climate
rmbl_data_clim_merge1 <- left_join(rmbl_data_merge, cru_all, by = c('site', 'year', 'month'))
cru_all$year
class(cru$year)
class(cru_all$year)
class(rmbl_data_merge$year)
rmbl_data_merge$year
as.numeric(rmbl_data_merge$year)
rmbl_data_merge$year = as.numeric(rmbl_data_merge$year)
## add in climate
rmbl_data_clim_merge1 <- left_join(rmbl_data_merge, cru_all, by = c('site', 'year', 'month'))
as.numeric(rmbl_data_merge$month)
rmbl_data_merge$month = as.numeric(rmbl_data_merge$month)
## add in climate
rmbl_data_clim_merge1 <- left_join(rmbl_data_merge, cru_all, by = c('site', 'year', 'month'))
head(rmbl_data_clim_merge1)
## add in climate
rmbl_data_clim_merge <- left_join(rmbl_data_merge, cru_all, by = c('site', 'year', 'month'))
head(rmbl_data_clim_merge)
tail(rmbl_data_clim_merge)
## write it out
write.csv(rmbl_data_clim_merge, '../data/rmbl_data_climate_merge.csv')
## read data
env_data <- readRDS('../data/rmbl_data_climate_merge.csv')
head(env_data)
## read data
env_data <- read.csv('../data/rmbl_data_climate_merge.csv')
head(env_data)
tail(env_data)
